#!/usr/bin/env bash

set -eu

if [[ -n ${NETWORK} ]]; then
	exec /usr/local/bin/run-network ${@}
fi
case ${1} in
	run) exec /usr/local/bin/run-node ${@} ;;
	cli) exec /usr/local/bin/run-cli ${@} ;;
	*) echo "Nothing to do! Perhaps try [run|cli], or set NETWORK environment variable."; exit 1 ;;
esac

# variables
CARDANO_BLOCK_PRODUCER=${CARDANO_BLOCK_PRODUCER:-false}
CARDANO_CONFIG=
CARDANO_DATABASE_PATH=
CARDANO_NETWORK=
CARDANO_NODE_SOCKET_PATH=${CARDANO_NODE_SOCKET_PATH:-/opt/cardano/ipc/socket}
CARDANO_PORT=${CARDANO_PORT:-3001}
CARDANO_RTS_OPTS=
CARDANO_SHELLEY_KES_KEY=
CARDANO_SHELLEY_OPERATIONAL_CERTIFICATE=
CARDANO_SHELLEY_VRF_KEY=
CARDANO_SOCKET_PATH=
CARDANO_TOPOLOGY=

exec cardano-node \
	--config ${CARDANO_CONFIG} \
	--topology ${CARDANO_TOPOLOGY} \
	--database-path ${CARDANO_DATABASE_PATH} \
	--socket-path ${CARDANO_SOCKET_PATH} \
	--host-addr 0.0.0.0 \
	--port ${CARDANO_PORT}
